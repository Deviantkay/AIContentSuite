<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Content Suite - Advanced Image Processing</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 min-h-screen font-sans antialiased">
    <!-- Toast Notification Container -->
    <div id="toastContainer" class="toastContainer fixed top-6 right-6 space-y-4 w-full max-w-sm z-50"></div>

    <!-- Main Container -->
    <div class="min-h-screen flex flex-col">
        <!-- Modern Header -->
        <header class="bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 text-white shadow-2xl sticky top-0 z-40 backdrop-blur-sm">
            <div class="max-w-7xl mx-auto px-6 py-8">
                <div class="text-center">
                    <div class="flex items-center justify-center space-x-3 mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                        <h1 class="text-4xl lg:text-5xl font-bold bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent">
                            AI Content Suite
                        </h1>
                    </div>
                    <p class="text-blue-100 text-xl font-medium mb-4">Advanced Image Metadata & Processing Tools</p>
                    <div class="flex items-center justify-center space-x-6 text-sm text-blue-200">
                        <span class="flex items-center space-x-2">
                            <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                            <span>AI Powered</span>
                        </span>
                        <span class="flex items-center space-x-2">
                            <div class="w-2 h-2 bg-blue-400 rounded-full"></div>
                            <span>Batch Processing</span>
                        </span>
                        <span class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                            </svg>
                            <span>Fast & Secure</span>
                        </span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow max-w-7xl mx-auto mt-8 mb-16 px-6 w-full">
            <!-- Modern Tab Navigation -->
            <div class="mb-8 relative">
                <!-- Mobile Menu Button -->
                <div class="lg:hidden flex justify-end mb-4">
                    <button id="hamburgerBtn" class="p-3 rounded-xl bg-white shadow-lg border border-slate-200 text-slate-600 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200">
                        <svg id="hamburgerIconOpen" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                        <svg id="hamburgerIconClose" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

                <!-- Tab Navigation -->
                <div id="tabNavigation" class="bg-white rounded-2xl shadow-xl border border-slate-200/50 p-2 backdrop-blur-sm hidden lg:block">
                    <div class="flex flex-wrap gap-2">
                        <button class="tab-button tab-active group" data-tab="generateContent">
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <span class="font-medium">Generate Metadata</span>
                            </div>
                        </button>
                        <button class="tab-button group" data-tab="readContent">
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10.392C2.057 15.71 3.245 16 4.5 16h1.051c.13-.386.298-.75.5-1.089V4.804zM14.5 4c-1.255 0-2.443.29-3.5.804v10.092c.202.34.37.703.5 1.09h4.449c.13-.386.298-.75.5-1.089V4.804C16.943 4.29 15.755 4 14.5 4zM10 2a1 1 0 00-1 1v12a1 1 0 002 0V3a1 1 0 00-1-1z" />
                                    </svg>
                                </div>
                                <span class="font-medium">Read Metadata</span>
                            </div>
                        </button>
                        <button class="tab-button group" data-tab="deleteContent">
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <span class="font-medium">Delete Metadata</span>
                            </div>
                        </button>
                        <button class="tab-button group" data-tab="convertContent">
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M5 3a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V5a2 2 0 00-2-2H5zm0 2h10v7h-2.586l-1.707-1.707A1 1 0 0010 10H9a1 1 0 00-.707.293L6.586 12H5V5zm11 5a1 1 0 100-2h-2a1 1 0 100 2h2z"/>
                                    </svg>
                                </div>
                                <span class="font-medium">Convert to JPEG</span>
                            </div>
                        </button>
                        <button class="tab-button group" data-tab="cropContent">
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-8 w-8">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M7.875 14.25l1.214 1.214a.75.75 0 001.06 0l4.293-4.292a1.875 1.875 0 000-2.652L12.207 6.28a.75.75 0 00-1.06 0L6.854 10.573M3 15V9m18 6V9m-9 12V3" />
                                    </svg>
                                </div>
                                <span class="font-medium">Crop Images</span>
                            </div>
                        </button>
                        <button class="tab-button group" data-tab="resizeContent">
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-8 w-8">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m4.5 11.25h-4.5m4.5 0v-4.5m0 0L15 15" />
                                    </svg>
                                </div>
                                <span class="font-medium">Resize Images</span>
                            </div>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Enhanced Progress Bar -->
            <div id="globalProgressContainer" class="mt-8 mb-6 hidden">
                <div class="bg-white rounded-2xl shadow-lg border border-slate-200/50 p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-600 animate-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                </svg>
                            </div>
                            <p id="progressMessage" class="text-lg font-semibold text-slate-700">Processing images...</p>
                        </div>
                        <p id="progressCounter" class="text-sm font-medium text-slate-500 bg-slate-100 px-3 py-1 rounded-full">0 / 0</p>
                    </div>
                    <div class="w-full bg-slate-200 rounded-full h-3 overflow-hidden">
                        <div id="globalProgressBar" class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-500 ease-out shadow-sm" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Tab Contents Container -->
            <div id="tabContentsContainer" class="bg-white rounded-2xl shadow-xl border border-slate-200/50 p-8 lg:p-10 backdrop-blur-sm">
                <!-- Generate Metadata Tab Content -->
                <div id="generateContent" class="tab-content space-y-8">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-3 flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    <span>Select Images</span>
                                </label>
                                <div id="generateFileDropZone" class="file-drop-zone group border-2 border-dashed border-slate-300 rounded-xl p-8 text-center hover:border-blue-400 hover:bg-blue-50/50 transition-all duration-300">
                                    <input type="file" id="imageFiles" accept="image/*" multiple class="hidden">
                                    <div class="flex flex-col items-center space-y-3">
                                        <div class="w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center group-hover:bg-blue-100 transition-colors duration-300">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-slate-400 group-hover:text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                            </svg>
                                        </div>
                                        <p class="text-slate-600 font-medium">Drag & drop your images here</p>
                                        <p class="text-sm text-slate-400">or click to browse</p>
                                    </div>
                                    <ul id="generateImageList" class="file-list mt-4"></ul>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <label for="apiKeys" class="block text-sm font-semibold text-slate-700 mb-3 flex items-center space-x-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
                                    </svg>
                                    <span>Gemini API Keys</span>
                                    <span class="text-red-500 text-xs">*Required</span>
                                </label>
                                <textarea id="apiKeys" placeholder="Enter your API keys here..." rows="4" class="input-field w-full resize-none rounded-xl border-2 border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all duration-300"></textarea>
                                <p class="mt-2 text-xs text-slate-500 flex items-center space-x-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span>Multiple keys will be rotated automatically. Saved securely in local storage.</span>
                                </p>
                            </div>
                        </div>
                    </div>
                     <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Optional: Upload JSON for Specific Metadata</label>
                         <input type="file" id="jsonMetadataFile" accept=".json" class="file-input-style">
                        <p class="mt-1 text-xs text-slate-500">JSON: `{"filename.jpg": {"title": "...", "subject":"...", "keywords":["k1"], "categories":["c1"], "author":"...", "copyright":"...", "context_for_gemini": "Focus on..."}}` or array of such objects.</p>
                    </div>
                    <div class="category-section">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="text-lg font-semibold text-slate-700">Content Categories (for Gemini)</h3>
                            <label class="flex items-center text-sm text-slate-600">
                                <input type="checkbox" id="autoDetect" class="checkbox-style" checked>
                                Auto-detect if none selected
                            </label>
                        </div>
                        <div id="generateCategoryGrid" class="category-grid"></div>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="renameFiles" class="checkbox-style">
                        <label for="renameFiles" class="ml-2 text-sm text-slate-600 cursor-pointer">Rename files based on generated titles (sanitized)</label>
                    </div>
                    <div class="flex flex-wrap gap-4 pt-2" id="generateActionsContainer">
                        <button id="generateBtn" class="button-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" /></svg>
                            Generate Metadata
                        </button>
                        <button id="downloadAllGeneratedBtn" class="button-success" style="display:none;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                            Download All (.zip)
                        </button>
                        <!-- CSV Button will be added here by JS -->
                    </div>
                    <div id="generateResults" class="results-container grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4"></div>
                </div>

                <!-- Read Metadata Tab Content -->
                <div id="readContent" class="tab-content space-y-6 hidden">
                    <label class="block text-sm font-medium text-slate-700 mb-1">Select Image (or drag & drop)</label>
                    <div id="readFileDropZone" class="file-drop-zone">
                        <input type="file" id="readImageFile" accept="image/jpeg,image/png,image/webp,image/gif,image/tiff" class="hidden"> <!-- Added tiff -->
                        <p class="text-slate-500">Drag 'n' drop an image here, or click to select</p>
                    </div>
                    <img id="readImagePreview" src="#" alt="Preview" class="image-preview hidden"/>
                    <div id="metadataResultsDisplay" class="metadata-display">
                        <p class="text-slate-500 italic">Select an image to view its metadata.</p>
                    </div>
                </div>

                <!-- Delete Metadata Tab Content -->
                <div id="deleteContent" class="tab-content space-y-6 hidden">
                    <label class="block text-sm font-medium text-slate-700 mb-1">Select JPEG (or drag & drop)</label>
                    <div id="deleteFileDropZone" class="file-drop-zone">
                        <input type="file" id="deleteImageFile" accept="image/jpeg" class="hidden">
                        <p class="text-slate-500">Drag 'n' drop a JPEG image here, or click to select</p>
                    </div>
                    <img id="deleteImagePreview" src="#" alt="Preview" class="image-preview hidden"/>
                    <button id="deleteMetadataBtn" class="button-danger">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>
                        Clear App Metadata & Download
                    </button>
                    <p class="text-xs text-slate-500">Clears XPTitle, Subject, Keywords, Comment, Author, Software tags. Others remain.</p>
                </div>

                <!-- Convert Tab Content -->
                <div id="convertContent" class="tab-content space-y-6 hidden">
                    <label class="block text-sm font-medium text-slate-700 mb-1">Select Images (or drag & drop)</label>
                    <div id="convertFileDropZone" class="file-drop-zone">
                         <input type="file" id="convertImageFiles" accept="image/*" multiple class="hidden">
                         <p class="text-slate-500">Drag 'n' drop images here, or click to select</p>
                         <ul id="convertImageList" class="file-list"></ul>
                    </div>
                    <div>
                        <label for="jpegQuality" class="block text-sm font-medium text-slate-700">JPEG Quality: <span id="jpegQualityValue">100</span>%</label>
                        <input type="range" id="jpegQuality" min="10" max="100" value="100" class="input-range">
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <button id="convertBtn" class="button-primary">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M5 3a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V5a2 2 0 00-2-2H5zm0 2h10v7h-2.586l-1.707-1.707A1 1 0 0010 10H9a1 1 0 00-.707.293L6.586 12H5V5zm11 5a1 1 0 100-2h-2a1 1 0 100 2h2z"/></svg>
                            Convert to JPEG
                        </button>
                        <button id="downloadAllConvertedBtn" class="button-success" style="display:none;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                            Download All (.zip)
                        </button>
                    </div>
                    <div id="convertResults" class="results-container grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4"></div>
                </div>

                <!-- Crop Tab Content -->
                <div id="cropContent" class="tab-content space-y-6 hidden">
                    <!-- Crop Mode Toggle -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-3">Crop Mode</label>
                        <div class="flex bg-slate-200 rounded-lg p-1 shadow-sm">
                            <button id="autoCropModeBtn" class="crop-mode-btn flex-1 py-2 px-4 text-sm font-medium rounded-md focus:outline-none">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 inline mr-2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" />
                                </svg>
                                Auto Crop (Batch)
                            </button>
                            <button id="manualCropModeBtn" class="crop-mode-btn flex-1 py-2 px-4 text-sm font-medium rounded-md focus:outline-none">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 inline mr-2">
                                     <path stroke-linecap="round" stroke-linejoin="round" d="M7.875 14.25l1.214 1.214a.75.75 0 001.06 0l4.293-4.292a1.875 1.875 0 000-2.652L12.207 6.28a.75.75 0 00-1.06 0L6.854 10.573M3 15V9m18 6V9m-9 12V3" />
                                </svg>
                                Manual Crop (Single Image)
                            </button>
                        </div>
                    </div>

                    <!-- Auto Crop Mode UI -->
                    <div id="autoCropModeUI" class="space-y-6">
                        <label class="block text-sm font-medium text-slate-700 mb-1">Select Images for Batch Auto-Crop (or drag & drop)</label>
                        <div id="cropFileDropZone" class="file-drop-zone">
                             <input type="file" id="cropImageFiles" accept="image/*" multiple class="hidden">
                             <p class="text-slate-500">Drag 'n' drop images here, or click to select</p>
                             <ul id="cropImageList" class="file-list"></ul>
                        </div>
                        <div>
                            <label for="cropAspectRatioAuto" class="block text-sm font-medium text-slate-700 mb-1">Aspect Ratio (Auto)</label>
                            <select id="cropAspectRatioAuto" class="select-field">
                                <option value="free">Free Form (Original Dimensions, Convert to JPEG)</option>
                                <option value="1.333333">4:3 (Landscape)</option>
                                <option value="0.75">3:4 (Portrait)</option>
                                <option value="1.777777">16:9 (Widescreen)</option>
                                <option value="0.5625">9:16 (Tall Screen)</option>
                                <option value="1">1:1 (Square)</option>
                            </select>
                        </div>
                        <p class="text-xs text-slate-500 -mt-4">Auto-crop from center for fixed ratios. Free Form converts without geometric changes.</p>

                        <div class="flex flex-wrap gap-4 pt-2">
                            <button id="startBatchCropBtn" class="button-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M7.875 14.25l1.214 1.214a.75.75 0 001.06 0l4.293-4.292a1.875 1.875 0 000-2.652L12.207 6.28a.75.75 0 00-1.06 0L6.854 10.573M3 15V9m18 6V9m-9 12V3" />
                                </svg>
                                Batch Auto-Crop & Download All (.zip)
                            </button>
                        </div>
                    </div>

                    <!-- Manual Crop Mode UI -->
                    <div id="manualCropModeUI" class="space-y-6 hidden">
                        <label class="block text-sm font-medium text-slate-700 mb-1">Select Single Image for Manual Crop (or drag & drop)</label>
                        <div id="manualCropFileDropZone" class="file-drop-zone">
                             <input type="file" id="manualCropImageFile" accept="image/*" class="hidden">
                             <p class="text-slate-500">Drag 'n' drop an image here, or click to select</p>
                             <ul id="manualCropImageList" class="file-list"></ul>
                        </div>

                        <!-- Cropper.js display area -->
                        <div id="manualCropperWrapper" class="mt-4 hidden border border-slate-300 rounded p-2 bg-slate-100" style="min-height: 250px;">
                            <div class="max-w-full mx-auto" style="height: 350px; overflow: hidden;"> <!-- Cropper.js needs a fixed height or explicit image height -->
                                 <img id="imageToCropManual" src="#" alt="Image for manual cropping">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                            <div>
                                <label for="manualCropAspectRatioSelect" class="block text-sm font-medium text-slate-700 mb-1">Aspect Ratio</label>
                                <select id="manualCropAspectRatioSelect" class="select-field" disabled>
                                    <option value="NaN">Free</option>
                                    <option value="1">1:1 (Square)</option>
                                    <option value="1.777777">16:9 (Widescreen)</option>
                                    <option value="1.333333">4:3 (Standard)</option>
                                    <option value="0.75">3:4 (Portrait)</option>
                                    <option value="0.5625">9:16 (Tall Screen)</option>
                                    <option value="0.666666">2:3 (Photo Portrait)</option>
                                    <option value="1.5">3:2 (Photo Landscape)</option>
                                </select>
                            </div>
                            <div>
                                <label for="manualCropOutputFormat" class="block text-sm font-medium text-slate-700 mb-1">Output Format</label>
                                <select id="manualCropOutputFormat" class="select-field" disabled>
                                    <option value="image/jpeg">JPEG</option>
                                    <option value="image/png">PNG</option>
                                    <option value="image/webp">WebP</option>
                                </select>
                            </div>
                            <div id="manualCropJpegQualityContainer" class="mt-2">
                                <label for="manualCropJpegQuality" class="block text-sm font-medium text-slate-700">JPEG Quality: <span id="manualCropJpegQualityValue">92</span>%</label>
                                <input type="range" id="manualCropJpegQuality" min="10" max="100" value="92" class="input-range" disabled>
                            </div>
                        </div>
                         <div class="flex items-center space-x-2 mt-2">
                            <button id="resetManualCropBtn" class="button-secondary-sm" disabled>Reset</button>
                            <button id="zoomInManualCropBtn" class="button-secondary-sm" disabled title="Zoom In">+</button>
                            <button id="zoomOutManualCropBtn" class="button-secondary-sm" disabled title="Zoom Out">-</button>
                            <button id="rotateLeftManualCropBtn" class="button-secondary-sm" disabled title="Rotate Left  CCW">↶</button>
                            <button id="rotateRightManualCropBtn" class="button-secondary-sm" disabled title="Rotate Right CW">↷</button>
                        </div>

                        <button id="applyManualCropAndDownloadBtn" class="button-primary" disabled>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
                            </svg>
                            Crop & Download Image
                        </button>
                    </div>
                    
                    <!-- Results Container (shared between both modes, auto-crop will populate this) -->
                    <div id="cropResults" class="results-container grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4"></div>
                </div>

                <!-- Resize Tab Content -->
                <div id="resizeContent" class="tab-content space-y-6 hidden">
                    <label class="block text-sm font-medium text-slate-700 mb-1">Select Images (or drag & drop)</label>
                    <div id="resizeFileDropZone" class="file-drop-zone">
                         <input type="file" id="resizeImageFiles" accept="image/*" multiple class="hidden">
                         <p class="text-slate-500">Drag 'n' drop images here, or click to select</p>
                         <ul id="resizeImageList" class="file-list"></ul>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="resizeMode" class="block text-sm font-medium text-slate-700 mb-1">Resize Mode</label>
                            <select id="resizeMode" class="select-field">
                                <option value="dimensions">By Dimensions</option>
                                <option value="percentage">By Percentage</option>
                            </select>
                        </div>
                        <div id="dimensionsInputsContainer">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="resizeWidth" class="block text-sm font-medium text-slate-700">Width (px)</label>
                                    <input type="number" id="resizeWidth" placeholder="e.g., 1920" class="input-field">
                                </div>
                                <div>
                                    <label for="resizeHeight" class="block text-sm font-medium text-slate-700">Height (px)</label>
                                    <input type="number" id="resizeHeight" placeholder="e.g., 1080" class="input-field">
                                </div>
                            </div>
                        </div>
                        <div id="percentageInputContainer" class="hidden">
                             <label for="resizePercentage" class="block text-sm font-medium text-slate-700">Percentage (%)</label>
                             <input type="number" id="resizePercentage" value="50" min="1" max="500" class="input-field">
                        </div>
                    </div>
                    <div class="flex items-center mt-2">
                        <input type="checkbox" id="maintainAspectRatioResize" class="checkbox-style" checked>
                        <label for="maintainAspectRatioResize" class="ml-2 text-sm text-slate-600 cursor-pointer">Maintain Aspect Ratio</label>
                    </div>
                     <div class="mt-4">
                        <label for="resizeOutputFormat" class="block text-sm font-medium text-slate-700 mb-1">Output Format</label>
                        <select id="resizeOutputFormat" class="select-field">
                            <option value="image/jpeg">JPEG</option>
                            <option value="image/png">PNG</option>
                            <option value="image/webp">WebP</option>
                        </select>
                    </div>
                     <div id="resizeJpegQualityContainer" class="mt-2">
                        <label for="resizeJpegQuality" class="block text-sm font-medium text-slate-700">JPEG Quality: <span id="resizeJpegQualityValue">92</span>%</label>
                        <input type="range" id="resizeJpegQuality" min="10" max="100" value="92" class="input-range">
                    </div>
                    <div class="flex flex-wrap gap-4 pt-2">
                        <button id="startBatchResizeBtn" class="button-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m4.5 11.25h-4.5m4.5 0v-4.5m0 0L15 15" /></svg>
                            Batch Resize & Download All (.zip)
                        </button>
                    </div>
                    <div id="resizeResults" class="results-container grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4"></div>
                </div>
            </div> <!-- End Tab Contents Container -->
        </main>

        <!-- Modern Footer -->
        <footer class="bg-white border-t border-slate-200/50 backdrop-blur-sm">
            <div class="max-w-7xl mx-auto px-6 py-8">
                <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                    <div class="flex items-center space-x-2">
                        <div class="w-6 h-6 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                        </div>
                        <span class="text-slate-600 font-medium">AI Content Suite</span>
                        <span class="text-slate-400">© <span id="currentYear">2025</span></span>
                    </div>
                    <div class="flex items-center space-x-4 text-sm text-slate-500">
                        <span class="flex items-center space-x-1">
                            <span>Crafted with</span>
                            <span class="text-red-500 animate-pulse">❤️</span>
                            <span>for creators</span>
                        </span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Enhanced Loader Modal -->
    <div id="loaderModal" class="loaderModal hidden fixed inset-0 bg-slate-900/60 backdrop-blur-md flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl shadow-2xl border border-slate-200/50 p-10 max-w-sm mx-4">
            <div class="flex flex-col items-center space-y-6">
                <div class="relative">
                    <div class="loader-spinner w-12 h-12"></div>
                    <div class="absolute inset-0 w-12 h-12 border-4 border-blue-500/20 rounded-full"></div>
                </div>
                <div class="text-center">
                    <p id="loaderMessage" class="text-slate-700 text-lg font-semibold mb-2">Processing your request...</p>
                    <p class="text-slate-500 text-sm">Please wait while we work our magic</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/piexifjs"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>
    <script src="script.js"></script>
</body>
</html>